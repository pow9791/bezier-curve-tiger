<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>3D Bézier Curve Tiger</title>
   <style>
      body { 
            font-family: sans-serif;
            background-color: #e0e0e0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        canvas {
            background-color: white;
            border: 2px solid #333;
            box-shadow: 0 4px 8px rgba[0, 0, 0, 0.2];
            margin: 20px 0;
        }
        .instructions {
            max-width: 800px;
            text-align: left;
            margin-top: 20px;
            line-height: 1.6;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba[0, 0, 0, 0.1];
        }
    </style>
</head>
<body>

    <h1>3D Bézier Curve Tiger</h1>
    <div class= "instructions">
        <p>This example demonstrates how a complex 3D-like shape can be constructed by combining multiple, distinct Bézier curves.</p>
        <ul>
            <li>The tiger is not a single curve, but a collection of several curves representing the body, legs, head, and tail.</li>
            <li>Each curve is defined in 3D space (with x, y, and z coordinates).</li>
            <li>A projection function maps these 3D points onto the 2D canvas, creating a sense of depth. Parts with a positive Z value appear closer, and parts with a negative Z value appear further away.</li>
            <li>The orange and black stripes are also individual Bézier curves drawn on top of the body.</li>
        </ul>
    </div>

    <canvas id="bezierCanvas" width="800" height="600"></canvas>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const canvas = document.getElementById('bezierCanvas');
            const ctx = canvas.getContext('2d');

            // --- Core 3D and Bézier Functions (Unchanged) ---
            function project3D(point3d) {
                const fov = 300; // Field of View (or perspective strength)
                const factor = fov / (fov + point3d.z);
                return {
                    x: (point3d.x - canvas.width / 2) * factor + canvas.width / 2,
                    y: (point3d.y - canvas.height / 2) * factor + canvas.height / 2,
                    scale: factor // To scale line width or point size for more depth
                };
            }

            function nCi(n, i) {
                if (i < 0 || i > n) return 0;
                if (i === 0 || i === n) return 1;
                if (i > n / 2) i = n - i;
                let res = 1;
                for (let j = 1; j <= i; j++) {
                    res = res * (n - j + 1) / j;
                }
                return res;
            }

            function getBezierPoint(t, points) {
                const n = points.length - 1;
                let x = 0, y = 0, z = 0;
                for (let i = 0; i <= n; i++) {
                    const bernsteinTerm = nCi(n, i) * Math.pow(1 - t, n - i) * Math.pow(t, i);
                    x += bernsteinTerm * points[i].x;
                    y += bernsteinTerm * points[i].y;
                    z += bernsteinTerm * points[i].z;
                }
                return { x, y, z };
            }
            
            // --- Modified Drawing Function ---
            // This function now draws one part of the tiger.
            function drawBezierPart(part) {
                const points = part.points;
                ctx.beginPath();
                
                const startPoint = getBezierPoint(0, points);
                const projectedStart = project3D(startPoint);
                ctx.moveTo(projectedStart.x, projectedStart.y);

                const numSteps = 100;
                for (let i = 1; i <= numSteps; i++) {
                    const t = i / numSteps;
                    const point = getBezierPoint(t, points);
                    const projectedPoint = project3D(point);
                    ctx.lineTo(projectedPoint.x, projectedPoint.y);
                }
                
                ctx.strokeStyle = part.color;
                ctx.lineWidth = part.lineWidth || 4; // Use part-specific line width or default to 4
                ctx.lineCap = 'round';
                ctx.stroke();
            }

            // ===================================================================
            // THIS IS THE SECTION THAT DEFINES THE TIGER SHAPE
            // We define the tiger as a collection of parts. Each part has:
            // - `points`: An array of 3D control points for its Bézier curve.
            // - `color`: The color of the line.
            // - `lineWidth`: The thickness of the line.
            // The Z-coordinate is crucial for the 3D effect:
            // - z > 0: Closer to the viewer
            // - z = 0: On the central plane
            // - z < 0: Further from the viewer
            // ===================================================================
            const tigerData = [
                // -- Body --
                { // Back Leg (far)
                    points: [ {x: 600, y: 450, z: -40}, {x: 650, y: 350, z: -45}, {x: 500, y: 300, z: -35}, {x: 450, y: 380, z: -40} ],
                    color: '#e67e22', lineWidth: 18
                },
                { // Front Leg (far)
                    points: [ {x: 300, y: 460, z: -30}, {x: 280, y: 350, z: -35}, {x: 220, y: 320, z: -30}, {x: 200, y: 400, z: -25} ],
                    color: '#e67e22', lineWidth: 16
                },
                { // Main Body Outline
                    points: [ {x: 200, y: 280, z: 0}, {x: 400, y: 150, z: 0}, {x: 600, y: 220, z: 0}, {x: 680, y: 350, z: 0} ],
                    color: '#d35400', lineWidth: 25
                },
                 { // Belly
                    points: [ {x: 250, y: 400, z: 5}, {x: 400, y: 430, z: 0}, {x: 550, y: 410, z: -5} ],
                    color: '#f39c12', lineWidth: 20
                },
                { // Back Leg (near)
                    points: [ {x: 550, y: 480, z: 40}, {x: 600, y: 380, z: 45}, {x: 450, y: 330, z: 35}, {x: 400, y: 420, z: 40} ],
                    color: '#e67e22', lineWidth: 20
                },
                { // Front Leg (near)
                    points: [ {x: 250, y: 490, z: 30}, {x: 230, y: 380, z: 35}, {x: 170, y: 350, z: 30}, {x: 150, y: 430, z: 25} ],
                    color: '#e67e22', lineWidth: 18
                },

                // -- Head and Tail --
                { // Head
                    points: [ {x: 120, y: 320, z: 20}, {x: 50, y: 250, z: 25}, {x: 150, y: 180, z: 20}, {x: 220, y: 260, z: 15} ],
                    color: '#d35400', lineWidth: 22
                },
                { // Snout
                    points: [ {x: 100, y: 300, z: 35}, {x: 40, y: 290, z: 40}, {x: 80, y: 260, z: 35} ],
                    color: '#f39c12', lineWidth: 12
                },
                { // Ear
                    points: [ {x: 180, y: 190, z: 15}, {x: 190, y: 150, z: 18}, {x: 210, y: 190, z: 15} ],
                    color: '#e67e22', lineWidth: 8
                },
                { // Tail
                    points: [ {x: 680, y: 350, z: -10}, {x: 750, y: 300, z: -15}, {x: 720, y: 200, z: -20}, {x: 650, y: 250, z: -10} ],
                    color: '#e67e22', lineWidth: 12
                },
                
                // -- Stripes (Black) --
                { // Stripe on back 1
                    points: [ {x: 500, y: 210, z: 10}, {x: 520, y: 300, z: 5}, {x: 480, y: 380, z: 10} ],
                    color: '#2c3e50', lineWidth: 8
                },
                { // Stripe on back 2
                    points: [ {x: 580, y: 280, z: 5}, {x: 600, y: 320, z: 0}, {x: 560, y: 380, z: 5} ],
                    color: '#2c3e50', lineWidth: 8
                },
                { // Stripe on middle body 1
                    points: [ {x: 380, y: 200, z: 10}, {x: 400, y: 280, z: 5}, {x: 370, y: 390, z: 10} ],
                    color: '#2c3e50', lineWidth: 7
                },
                 { // Stripe on middle body 2
                    points: [ {x: 430, y: 180, z: 10}, {x: 450, y: 260, z: 5}, {x: 420, y: 370, z: 10} ],
                    color: '#2c3e50', lineWidth: 7
                },
                { // Stripe on shoulder 1
                    points: [ {x: 280, y: 250, z: 10}, {x: 290, y: 320, z: 15}, {x: 260, y: 380, z: 25} ],
                    color: '#2c3e50', lineWidth: 7
                },
                { // Stripe on shoulder 2
                    points: [ {x: 320, y: 220, z: 10}, {x: 330, y: 290, z: 15}, {x: 300, y: 350, z: 25} ],
                    color: '#2c3e50', lineWidth: 7
                },
                { // Stripe on near hind leg 1
                    points: [ {x: 480, y: 350, z: 48}, {x: 520, y: 400, z: 50}, {x: 490, y: 450, z: 48} ],
                    color: '#2c3e50', lineWidth: 6
                },
                { // Stripe on near hind leg 2
                    points: [ {x: 420, y: 380, z: 48}, {x: 460, y: 430, z: 50}, {x: 430, y: 480, z: 48} ],
                    color: '#2c3e50', lineWidth: 6
                },
                { // Stripe on far hind leg
                    points: [ {x: 550, y: 330, z: -38}, {x: 580, y: 370, z: -40}, {x: 550, y: 420, z: -38} ],
                    color: '#2c3e50', lineWidth: 6
                },
                { // Stripe on near front leg 1
                    points: [ {x: 190, y: 370, z: 38}, {x: 220, y: 410, z: 40}, {x: 190, y: 460, z: 38} ],
                    color: '#2c3e50', lineWidth: 6
                },
                { // Stripe on near front leg 2
                    points: [ {x: 170, y: 340, z: 38}, {x: 200, y: 380, z: 40}, {x: 170, y: 430, z: 38} ],
                    color: '#2c3e50', lineWidth: 6
                },
                { // Stripe on far front leg
                    points: [ {x: 250, y: 340, z: -28}, {x: 280, y: 380, z: -30}, {x: 250, y: 430, z: -28} ],
                    color: '#2c3e50', lineWidth: 6
                },
                { // Stripe on head 1
                    points: [ {x: 150, y: 230, z: 28}, {x: 100, y: 210, z: 30}, {x: 70, y: 250, z: 28} ],
                    color: '#2c3e50', lineWidth: 5
                },
                { // Stripe on head 2
                    points: [ {x: 200, y: 240, z: 20}, {x: 150, y: 200, z: 22}, {x: 120, y: 240, z: 20} ],
                    color: '#2c3e50', lineWidth: 5
                },
                { // Stripe on snout
                    points: [ {x: 80, y: 270, z: 42}, {x: 60, y: 280, z: 45}, {x: 70, y: 295, z: 42} ],
                    color: '#2c3e50', lineWidth: 4
                },
                { // Stripe on tail 1
                    points: [ {x: 710, y: 280, z: -12}, {x: 730, y: 250, z: -18}, {x: 700, y: 230, z: -15} ],
                    color: '#2c3e50', lineWidth: 5
                },
                { // Stripe on tail 2
                    points: [ {x: 700, y: 320, z: -10}, {x: 720, y: 290, z: -15}, {x: 690, y: 260, z: -12} ],
                    color: '#2c3e50', lineWidth: 5
                },
                { // Stripe on tail 3 (tip)
                    points: [ {x: 680, y: 220, z: -18}, {x: 660, y: 200, z: -22}, {x: 630, y: 220, z: -20} ],
                    color: '#2c3e50', lineWidth: 4
                }
            ];

            // --- Main Drawing Loop ---
            function drawScene() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Sort parts by their average Z value so far-away parts are drawn first.
                // This creates correct layering (occlusion).
                const sortedParts = tigerData.sort((a, b) => {
                    const zA = a.points.reduce((sum, p) => sum + p.z, 0) / a.points.length;
                    const zB = b.points.reduce((sum, p) => sum + p.z, 0) / b.points.length;
                    return zA - zB;
                });
                
                // Draw each part of the tiger
                sortedParts.forEach(part => {
                    drawBezierPart(part);
                });
            }

            // Initial draw
            drawScene();
        });
    </script>
</body>
</html>